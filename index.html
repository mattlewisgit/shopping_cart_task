<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kingfisher Shopping Cart</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .section-header {
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
      background: #ddd;
      padding: 5px;
      border-radius: 5px;
    }
    .products {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 5px;
    }
    .product {
      border: 1px solid #ccc;
      border-radius: 5px;
      padding: 5px;
      width: 150px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #fff;
      position: relative;
    }
    .product img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      margin-bottom: 5px;
    }
    .out-of-stock {
      position: absolute;
      top: 0;
      left: 0;
      background: rgba(255,0,0,0.7);
      color: #fff;
      width: 100%;
      text-align: center;
      font-weight: bold;
      border-radius: 5px 5px 0 0;
      padding: 2px 0;
    }
    .cart {
      margin-top: 30px;
      border: 2px solid #444;
      border-radius: 10px;
      padding: 10px;
      background: #fff;
    }
    .cart-item {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-bottom: 5px;
    }
    .cart-item img {
      width: 40px;
      height: 40px;
    }
    .cart-total {
      font-weight: bold;
      margin-top: 10px;
    }
    #checkout {
      margin-top: 10px;
      padding: 5px 10px;
    }
    #overlay {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
    }
    #loginPopup {
      display: none;
      position: fixed;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      width: 250px;
      text-align: center;
      z-index: 10;
    }
    #loginPopup input {
      width: 90%;
      margin: 5px 0;
      padding: 5px;
    }
    .close-btn {
      position: absolute;
      top: 5px; right: 10px;
      cursor: pointer;
      font-size: 18px;
    }
    .error { color: red; }
    .success { color: green; }
    .discount-container {
      margin-top: 10px;
    }
    .discount-container input {
      padding: 5px;
      width: 150px;
    }
    .discount-container button {
      padding: 5px 10px;
    }
  </style>
</head>
<body>

<h1>Kingfisher Shopping Cart</h1>

<!-- Sections -->
<div>
  <div class="section-header" onclick="toggleSection(this)">Fruits</div>
  <div class="products">
    <div class="product">
      <img src="https://dummyimage.com/80x80/ff9999/000000&text=Apple" alt="Apple">
      <p>Apple (£1.00) - Stock: <span id="stock-Apple">5</span></p>
      <input type="number" min="1" value="1" id="qty-Apple">
      <button onclick="addToCart('Apple',1.00,document.getElementById('qty-Apple').value,'https://dummyimage.com/80x80/ff9999/000000&text=Apple',5)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ffcc99/000000&text=Banana" alt="Banana">
      <p>Banana (£0.50) - Stock: <span id="stock-Banana">0</span></p>
      <div class="out-of-stock">Out of Stock</div>
      <input type="number" min="1" value="1" id="qty-Banana" disabled>
      <button disabled>Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ffff99/000000&text=Orange" alt="Orange">
      <p>Orange (£0.80) - Stock: <span id="stock-Orange">6</span></p>
      <input type="number" min="1" value="1" id="qty-Orange">
      <button onclick="addToCart('Orange',0.80,document.getElementById('qty-Orange').value,'https://dummyimage.com/80x80/ffff99/000000&text=Orange',6)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ccffcc/000000&text=Grapes" alt="Grapes">
      <p>Grapes (£2.00) - Stock: <span id="stock-Grapes">10</span></p>
      <input type="number" min="1" value="1" id="qty-Grapes">
      <button onclick="addToCart('Grapes',2.00,document.getElementById('qty-Grapes').value,'https://dummyimage.com/80x80/ccffcc/000000&text=Grapes',10)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ccccff/000000&text=Kiwi" alt="Kiwi">
      <p>Kiwi (£1.50) - Stock: <span id="stock-Kiwi">8</span></p>
      <input type="number" min="1" value="1" id="qty-Kiwi">
      <button onclick="addToCart('Kiwi',1.50,document.getElementById('qty-Kiwi').value,'https://dummyimage.com/80x80/ccccff/000000&text=Kiwi',8)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ffccff/000000&text=Mango" alt="Mango">
      <p>Mango (£1.80) - Stock: <span id="stock-Mango">4</span></p>
      <input type="number" min="1" value="1" id="qty-Mango">
      <button onclick="addToCart('Mango',1.80,document.getElementById('qty-Mango').value,'https://dummyimage.com/80x80/ffccff/000000&text=Mango',4)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/99ccff/000000&text=Peach" alt="Peach">
      <p>Peach (£1.20) - Stock: <span id="stock-Peach">7</span></p>
      <input type="number" min="1" value="1" id="qty-Peach">
      <button onclick="addToCart('Peach',1.20,document.getElementById('qty-Peach').value,'https://dummyimage.com/80x80/99ccff/000000&text=Peach',7)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ff9966/000000&text=Pear" alt="Pear">
      <p>Pear (£1.10) - Stock: <span id="stock-Pear">9</span></p>
      <input type="number" min="1" value="1" id="qty-Pear">
      <button onclick="addToCart('Pear',1.10,document.getElementById('qty-Pear').value,'https://dummyimage.com/80x80/ff9966/000000&text=Pear',9)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/99ffcc/000000&text=Plum" alt="Plum">
      <p>Plum (£1.30) - Stock: <span id="stock-Plum">6</span></p>
      <input type="number" min="1" value="1" id="qty-Plum">
      <button onclick="addToCart('Plum',1.30,document.getElementById('qty-Plum').value,'https://dummyimage.com/80x80/99ffcc/000000&text=Plum',6)">Add</button>
    </div>
    <div class="product">
      <img src="https://dummyimage.com/80x80/ffcc66/000000&text=Strawberry" alt="Strawberry">
      <p>Strawberry (£2.50) - Stock: <span id="stock-Strawberry">3</span></p>
      <input type="number" min="1" value="1" id="qty-Strawberry">
      <button onclick="addToCart('Strawberry',2.50,document.getElementById('qty-Strawberry').value,'https://dummyimage.com/80x80/ffcc66/000000&text=Strawberry',3)">Add</button>
    </div>
  </div>
</div>

<!-- Cart -->
<div class="cart">
  <h2>Shopping Cart</h2>
  <div id="cartItems">Basket is empty</div>
  <div class="cart-total" id="cartTotal">Total: £0.00</div>

  <!-- Discount -->
  <div class="discount-container">
    <input type="text" id="discountCode" placeholder="Discount Code">
    <button onclick="applyDiscount()">Apply</button>
    <div id="discountMessage"></div>
  </div>

  <button id="checkout" onclick="checkout()">Checkout</button>
</div>

<!-- Login popup -->
<div id="overlay"></div>
<div id="loginPopup">
  <span class="close-btn" onclick="closeLogin()">×</span>
  <h3>Login to continue</h3>
  <input type="text" id="username" placeholder="Username"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button onclick="login()">Login</button>
</div>

<script>
let cart = {};
let discount = 0;

// Section toggle
function toggleSection(el) {
  const productsDiv = el.nextElementSibling;
  productsDiv.style.display = productsDiv.style.display === 'none' ? 'flex' : 'none';
}

// Add to cart
function addToCart(name, price, qty, img, stock) {
  qty = parseInt(qty);
  if (isNaN(qty) || qty < 1) return;
  if (qty > stock) { alert('Not enough stock'); return; }
  if (cart[name]) {
    cart[name].quantity += qty;
  } else {
    cart[name] = { price, quantity: qty, img };
  }
  updateCart();
}

// Update cart
function updateCart() {
  const cartItems = document.getElementById('cartItems');
  cartItems.innerHTML = '';
  let total = 0;
  for (let item in cart) {
    const lineTotal = cart[item].price * cart[item].quantity;
    total += lineTotal;
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `<img src="${cart[item].img}"> ${item} (£${cart[item].price}) x ${cart[item].quantity} = £${lineTotal.toFixed(2)} <button onclick="removeFromCart('${item}')">Remove</button>`;
    cartItems.appendChild(div);
  }
  if (Object.keys(cart).length === 0) {
    cartItems.innerText = 'Basket is empty';
  }
  const totalWithDiscount = total * (1 - discount);
  document.getElementById('cartTotal').innerText = `Total: £${totalWithDiscount.toFixed(2)}`;
}

// Remove item
function removeFromCart(name) {
  delete cart[name];
  updateCart();
}

// Discount codes 10% to 100%
const discountCodes = {};
for (let i = 10; i <= 100; i += 10) {
  discountCodes[`SAVE${i}`] = i / 100;
}
function applyDiscount() {
  const code = document.getElementById('discountCode').value.trim().toUpperCase();
  const message = document.getElementById('discountMessage');
  if (discountCodes[code]) {
    discount = discountCodes[code];
    message.className = 'success';
    message.innerText = `Discount applied: ${discount * 100}%`;
  } else {
    discount = 0;
    message.className = 'error';
    message.innerText = 'Invalid discount code';
  }
  updateCart();
}

// Checkout login
function checkout() {
  document.getElementById('overlay').style.display = 'block';
  document.getElementById('loginPopup').style.display = 'block';
}

function closeLogin() {
  document.getElementById('overlay').style.display = 'none';
  document.getElementById('loginPopup').style.display = 'none';
}

function login() {
  const user = document.getElementById('username').value;
  const pass = document.getElementById('password').value;
  alert(`Logged in as ${user}`);
  closeLogin();
}
</script>

</body>
</html>
